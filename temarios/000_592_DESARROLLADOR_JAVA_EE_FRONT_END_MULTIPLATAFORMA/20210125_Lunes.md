# 20210125 Lunes

# Docker

## Contenedores Docker

![20210125-01](images2/20210125-01.png)
![20210125-02](images2/20210125-02.png)

Pongamonos en situación, si nosotros como desarrolladores desarrollamos una aplicación y la tenemos que distribuir ya sea Servicio, MicroServicio, Aplicación Web, tendríamos que generar el JAR o WAR según corresponda, pero esto no es independiente para ejecutar ese JAR o WAR necesitaremos un Servidor de aplicaciones, BD, etc, el proceso que se tiene desde que se termina un desarrollo hasta que se pone en Producción requiere ua tarea que se llama ***el Despliegue*** que implica tener todas las consideraciones necesarias para que la aplicación pueda ejecutarse, JDK, Maquina Virtual, etc, es un proceso que alguien tiene que hacer, esto implica que debe haber unos requerimientos necesarios en la maquina destino, muchos problemas.  

El objetivo de los Contenedores es facilitar toda la tarea de distribución de una aplicación, es decir tu quieres distribuir una aplicación y esta necesita esto, esto y esto pues en vez de desplegar la aplicación sola es crear un contenedor,  en el contenedor va a estar almacenada la aplicación más todo el software que necesita para que funcione como la versión del JDK, Tomcat, BD, etc. Ya no se distribuye la aplicación, se distribuye el Contenedor, con lo cual cuando quieras instalar la aplicación en algún sitio lo único que hay que hacer es desplegar en ese sitio el contenedor, que es una instrucción de línea de comandos. Ese equipo destino no necesita tener nada, ya que en el contenedor va a estar todo lo necesario para que la aplicación funcione.

Una consideración que debemos tener en cuenta es que ***un contenedor esta pensado para incluir una aplicación solamente, un componente*** Cada conteneror con su aplicación así que si neccesito una BD esta ira en otro contenedor.

Antes esto se hacia con Maquinas Virtuales pero estas son muy pesadas por que llevan su propio S.O, en cambio los contenedores son muy ligeros, portables, sin S.O ya que tiran del S.O de la maquina.

![20210125-03](images2/20210125-03.png)

Docker es el más popular en cuanto a contenedores.
Cada contenedor lleva su aplicacion puedo tener varios, hay componente por debajo que permite esta magia quue es **Docker Engine** por lo que en la maquina que quiera desplegar el contenedor necesita tener Docker Engine.

![20210125-04](images2/20210125-04.png)

Los contenedores son ideales para desplegar los MicroServicios, pero los MicroServicios para funcionar necesitan JVM, JSE, JDK por lo que yo no puedo distribuir un MicroServicio a cualquier maquina ya que si yo lo desarrolle con una versión 11 y la maquina tiene una versión 7 o simplemente no tiene JDK puede haber conflictos, de lo contrario si meto ese MicroServicio con todo lo que necesita en el destinatario ***solo voy a necesitar tener el Docker Engine*** pero allí nadie tendra que instalar el JDK, ni nada de nada, si hablamos de una BD MySQL la puedo meter en un contenedor y me la puedo llevar a cualquier maquina que no tenga instalado MySQL, es bastante pontente y nos facilita la vida.

![20210125-05](images2/20210125-05.png)

Cuando se trabaja con Docker tenemos los conceptos de 

* Imagen: Es como la clase
* Contenedor: Es como el objeto.

Para crear un Contenedor necesito una Imagen. La imagen determina todo lo que se contiene para que la aplicación funcione. Una vez que ya tengo la Imagen puedo crear diferentes contenedores con la misma instancia de un servicio.

Para usar docker puedo usar la Maquina Virtual de Ubunto o en el caso de la Mac me vale usar la consola.

## Instalación de Docker

![20210125-06](images2/20210125-06.png)
![20210125-07](images2/20210125-07.png)
![20210125-08](images2/20210125-08.png)
![20210125-09](images2/20210125-09.png)

```sh
mini-de-adolfo:~ adolfodelarosa$ docker -v
Docker version 20.10.0, build 7287ab3
mini-de-adolfo:~ adolfodelarosa$ 
```

![20210125-10](images2/20210125-10.png)

Ver Imagenes Docker

![20210125-33](images2/20210125-33.png)

Existen muchas imagenes ya existentes listas para usar sus contenedores. 

Si conocemos el nombre de una Imagen nos la podemos descargar con el Comando : `docker pull tomcat`:

![20210125-40](images2/20210125-40.png)
![20210125-41](images2/20210125-41.png)

Ahora ya tengo la image `tomcat` para crear el contenedor de `tomcat` lo hacemos con el comando `docker run tomcat`:

![20210125-36](images2/20210125-36.png)

Como el terminal se queda ejecutando Tomcat necesito abrir otra terminal.


Ver Contenedores en Ejecución con  `docker ps -a`
![20210125-42](images2/20210125-42.png)

Ver Contenedores en Ejecución con  `docker ps`

![20210125-37](images2/20210125-37.png)

Podría pensarse que si cargamos la URL http://localhost:8080 veriamos algo.
![20210125-43](images2/20210125-43.png)

Pero no puede acceder a la URL http://localhost:8080 y esto pasa por que Tomcat esta arrancado dentro del Contenedor y yo estoy tratando al contenedor desde fuera y no tenemos acceso, por eso nos marca ese error. Ya veremos como hacerlo.

Para detener un Contenedor necesitamos el Id de Contenedor y usamos el comando `docker stop identificador`

![20210125-38](images2/20210125-38.png)

Ver Contenedores en Ejecución

![20210125-34](images2/20210125-34.png)

El contenedor existe pero esta Exited.

Eliminar una Imagen `docker rmi imagen`

![20210125-39](images2/20210125-39.png)

Eliminar un Contenedor `docker rm identificador-contenedor`

![20210125-44](images2/20210125-44.png)

OJO Eliminar el Contenedor es como borrarlo de la Memoria, borrar la Imagen es borrar fisicamente toda la Imagen.

### Docker Hub

https://hub.docker.com/

![20210125-45](images2/20210125-45.png)
![20210125-46](images2/20210125-46.png)


## Gestión de Contenedores

![20210125-11](images2/20210125-11.png)
![20210125-12](images2/20210125-12.png)
![20210125-13](images2/20210125-13.png)
![20210125-14](images2/20210125-14.png)
![20210125-15](images2/20210125-15.png)
![20210125-16](images2/20210125-16.png)
![20210125-17](images2/20210125-17.png)
![20210125-18](images2/20210125-18.png)

## Creación de Imágenes Docker

![20210125-19](images2/20210125-19.png)
![20210125-20](images2/20210125-20.png)
![20210125-21](images2/20210125-21.png)
![20210125-22](images2/20210125-22.png)
![20210125-23](images2/20210125-23.png)
![20210125-24](images2/20210125-24.png)
![20210125-25](images2/20210125-25.png)
![20210125-26](images2/20210125-26.png)
![20210125-27](images2/20210125-27.png)

## Docker Hub

![20210125-28](images2/20210125-28.png)
![20210125-29](images2/20210125-29.png)
![20210125-30](images2/20210125-30.png)
![20210125-31](images2/20210125-31.png)
![20210125-32](images2/20210125-32.png)

