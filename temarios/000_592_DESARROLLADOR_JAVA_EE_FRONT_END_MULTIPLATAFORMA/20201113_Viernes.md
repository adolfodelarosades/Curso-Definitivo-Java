# 20201113 Viernes

## Instalación de Web Logic

Lo primero que debemos hace es descargar Web Logic de https://www.oracle.com/middleware/technologies/weblogic-server-installers-downloads.html vamos a descargar la versión Oracle WebLogic Server 12.2.1.3

![19-01-ej](images/19-X-01-ej.png)

Nos descarga un Zip que desempaqueteamos en alguna carpeta.

![19-02-ej](images/19-X-02-ej.png)

Con la Consola nos colocamos en la carpeta donde lo desempaquetamos e intentamos instalar el JAR.

![19-05-ej](images/19-X-05-ej.png)

Nos marca un error por la versión de Java.

![19-06-ej](images/19-X-06-el.png)

**LA VERSIÓN DE WEB LOGIC 12.2.1.3 SOLO SE PUEDE INSTALAR CON JAVA 8** 

Bajamos a la versión de Java 8 e intentamos instalar de nuevo.

![19-10-ej](images/19-X-10-ej.png)

![19-11-ej](images/19-X-11-ej.png)

Si en Eclipse intentamos instalar un nuevo server y nos vamos a Oracle nos presnta la siguiente pantalla:

![19-03-ej](images/19-X-03-ej.png)

Como es la primera vez que entramos a estra opción debemos Instalar **Oracle WebLogic Server Tools*** al dar siguiente nos pedira que aceptemos los terminos y empezara a instalar las Tools, al finalizar reiniciará Eclipse.

Si volvemos a entrar a la misma opción tendremos 

![19-04-ej](images/19-X-04-ej.png)

Seleccionamos Oracle WebLogic Server y continuamos con el proceso de instalación.

![19-12-ej](images/19-12-ej.png)

![19-13-ej](images/19-13-ej.png)

Una vez que ya he añadido un nuevo Server en Eclipse lo añado en la Pestaña Servers.

![19-14-ej](images/19-14-ej.png)

![19-15-ej](images/19-15-ej.png)

## Creación del DataSource en WebLogic

![19-17-ej](images/19-17-ej.png)
![19-18-ej](images/19-18-ej.png)
![19-19-ej](images/19-19-ej.png)
![19-20-ej](images/19-20-ej.png)
![19-21-ej](images/19-21-ej.png)
![19-22-ej](images/19-22-ej.png)
![19-23-ej](images/19-23-ej.png)
![19-24-ej](images/19-24-ej.png)
![19-25-ej](images/19-25-ej.png)
![19-26-ej](images/19-26-ej.png)
![19-27-ej](images/19-27-ej.png)
![19-28-ej](images/19-28-ej.png)
![19-29-ej](images/19-29-ej.png)
![19-30-ej](images/19-30-ej.png)
![19-31-ej](images/19-31-ej.png)
![19-32-ej](images/19-32-ej.png)
![19-33-ej](images/19-33-ej.png)
![19-34-ej](images/19-34-ej.png)
![19-35-ej](images/19-35-ej.png)
![19-36-ej](images/19-36-ej.png)
![19-37-ej](images/19-37-ej.png)

## :computer: `20_gestion_candidatos_ejb_weblogic`

Vamos a crear un nuevo proyecto pero con servidor WebLogic.

![19-38-ej](images/19-38-ej.png)

### 01. Mavenizar el Proyecto y poner las dependencias

![19-39-ej](images/19-39-ej.png)

En este caso como vamos a usar un DataSource que se encuentra en el servidor de aplicaciones WebLogig no necesitamos añadir la dependendia de MySQL y a que esto lo va a gestionar WebLogic.

`pom.xml`

```html
<dependencies>
   <!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-core --> 
   <dependency>
      <groupId>org.hibernate</groupId>
      <artifactId>hibernate-core</artifactId>
      <version>5.4.18.Final</version>
   </dependency>
</dependencies>
```

### 02. Dar Características JPA

![19-40-ej](images/19-40-ej.png)

Hasta ahora siempre veniamos usando conexiones a las BD desde la aplicación.

![19-41-ej](images/19-41-1-ej.png)

En este ejemplo vamos a usar un DataSorce que obviamente ya no esta dentro de la aplicación por lo que debemos seleccionar en **Transaction Type: JTA** y en **JTA data source: jdbc/empresads**

![19-41-ej](images/19-41-ej.png)

### 03. Crear la Entidad `Candidato`

Podemos copiar la Entidad `Candidato` del proyecto `0017_gestion_candidatos_mvc`, pero curiosamente al usar WebLogic nos va a marcar los siguientes errores.

![19-50-ej](images/19-50-ej.png)

Para eliminar el error debemos usar la anotación `@NamedQueries({...})` para agrupar el conjunto de `@NamedQuery(...)`

![19-51-ej](images/19-51-ej.png)

Por lo que nuestra entidad nos queda así:

`Candidato`

```java
package model;

import java.io.Serializable;
import javax.persistence.*;

@Entity
@Table(name="candidatos")
@NamedQueries({
   @NamedQuery(name="Candidato.findAll", query="SELECT c FROM Candidato c"),
   @NamedQuery(name="Candidato.findByPuesto", query="Select c From Candidato c Where c.puesto = ?1"),
   @NamedQuery(name="Candidato.findByEmail", query="Select c From Candidato c Where c.email = ?1"),
   @NamedQuery(name="Candidato.deleteByEmail", query="Delete From Candidato c Where c.email = ?1"),
})
public class Candidato implements Serializable {
   private static final long serialVersionUID = 1L;

   @Id
   @GeneratedValue(strategy=GenerationType.IDENTITY)
   private int idCandidato;

   @Column(name="edad")
   private int edad;
   private String email;
   private String foto;
   private String nombre;
   private String puesto;

   public Candidato() {
   }

   public Candidato(int idCandidato, int edad, String email, String foto, String nombre, String puesto) {
      super();
      this.idCandidato = idCandidato;
      this.edad = edad;
      this.email = email;
      this.foto = foto;
      this.nombre = nombre;
      this.puesto = puesto;
   }

   public int getIdCandidato() {
      return this.idCandidato;
   }

   public void setIdCandidato(int idCandidato) {
      this.idCandidato = idCandidato;
   }

   public int getEdad() {
      return this.edad;
   }

   public void setEdad(int edad) {
      this.edad = edad;
   }

   public String getEmail() {
      return this.email;
   }

   public void setEmail(String email) {
      this.email = email;
   }

   public String getFoto() {
      return this.foto;
   }

   public void setFoto(String foto) {
      this.foto = foto;
   }

   public String getNombre() {
      return this.nombre;
   }

   public void setNombre(String nombre) {
      this.nombre = nombre;
   }

   public String getPuesto() {
      return this.puesto;
   }
   
   public void setPuesto(String puesto) {
      this.puesto = puesto;
   }

}
```

### 04. Añadir Entidad al `persistence.xml`

Ya teniendo nuestra Entidad la añadimos al archivo `persistence.xml` el cual nos queda así:

![19-42-ej](images/19-42-ej.png)

`persistence.xml`

```html
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.2" xmlns="http://xmlns.jcp.org/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd">
   <persistence-unit name="empresaPU" transaction-type="JTA">
      <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>
      <jta-data-source>jdbc/empresads</jta-data-source>
      <class>model.Candidato</class>
      <properties>			
         <property name="hibernate.transaction.jta.platform" value="org.hibernate.engine.transaction.jta.platform.internal.WeblogicJtaPlatform"/>				
         </properties>
   </persistence-unit>
</persistence>
```

### 05. Creación de la Capa de Negocios con EJBs.


![19-43-ej](images/19-43-ej.png)
![19-44-ej](images/19-44-ej.png)
![19-45-ej](images/19-45-ej.png)
![19-46-ej](images/19-46-ej.png)
![19-47-ej](images/19-47-ej.png)
![19-48-ej](images/19-48-ej.png)
![19-49-ej](images/19-49-ej.png)

![19-52-ej](images/19-52-ej.png)
![19-53-ej](images/19-53-ej.png)
![19-54-ej](images/19-54-ej.png)
![19-55-ej](images/19-55-ej.png)
![19-56-ej](images/19-56-ej.png)
![19-57-ej](images/19-57-ej.png)
![19-58-ej](images/19-58-ej.png)
![19-59-ej](images/19-59-ej.png)
![19-60-ej](images/19-60-ej.png)
![19-61-ej](images/19-61-ej.png)
![19-62-ej](images/19-62-ej.png)
![19-63-ej](images/19-63-ej.png)
![19-64-ej](images/19-64-ej.png)
![19-65-ej](images/19-65-ej.png)
![19-66-ej](images/19-66-ej.png)
![19-67-ej](images/19-67-ej.png)
![19-68-ej](images/19-68-ej.png)
![19-69-ej](images/19-69-ej.png)
![19-70-ej](images/19-70-ej.png)
![19-71-ej](images/19-71-ej.png)
![19-72-ej](images/19-72-ej.png)

